<?php
require_once "BigInteger.php";
require_once "Random.php";
require_once "Hash.php";
require_once "Rsa.class.php";

function decryptrsa($md)
{
    $rsa_d = "1476923941723488029195280431416862106838784621065781340133073495372318857073821995966911561908250482946547335724053250608409507221128397480903559571629940642522123235599299397877608807482682546299868846682125767348295006342527827302746619527385219044860105506760176662062629532651309946284728420219405949492273610353538320016440360294382069630950510979700490781219950177345526937855538536588648898923393670336599281375785624843088195315785692522021166721278236787439125189888979651580420584997619731740406855442969757711531233661883912603626252215441456973513838349597829613540803890223871341382025047325084209031881";
    $rsa_m = "5101591713296444485781585448703299372411824535636332015833412678778900036775773256722428694107956859019677124181910592142487615757930623261198924096819718363456798439127210413454647920153095025980754201293903496259606996844672686288343914229194298046215594143920935764702592539244020343078747525431599337917705621386893408651675170095762835718970513039214066698724895667210699840608633050031441363816620462676272205154270435180225284630846187016570488549107042984263028898838814137118606328861056952542797266400712202214392937678438838135559956971093413262245670628361810398361916937845901101487549419668414989495903";
    $pwd = $md;

    $rsa = new Crypt_RSA();
    $rsa->exponent = new Math_BigInteger($rsa_d, 10);
    $rsa->modulus = new Math_BigInteger($rsa_m, 10);
    $rsa->k = 2048;

    function hexToStr($hex)
    {
        $string = "";
        for ($i = 0; $i < strlen($hex) - 1; $i += 2)
            $string .= chr(hexdec($hex[$i] . $hex[$i + 1]));
        return $string;
    }

    $m = $rsa->decrypt(hexToStr($pwd));
    return $m;
}
